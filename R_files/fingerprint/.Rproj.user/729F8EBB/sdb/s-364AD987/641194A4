{
    "collab_server" : "",
    "contents" : "# Year: 2017\n# Title: Test Lineare, due raspberry pi e dispositivi a distanze note da 2 a 10 metri\n# Goal: Capire dipendenza tra rssi e WIFI rx\n# Author: Edoardo Longo\n#\n# \n\n# Define your working directory\n# Ensure to use the forward / slash \nsetwd(\"/Users/edoardesd/Documents/R_files\")\ngetwd()\n\n#es: DATASET: timestamp | rssi |  rx(wifi)\n#               12:24:23|  -10 | -68\n\n#INIZIO IMPORT\nrequire(class)\nlibrary(readr)\nrequire(ggplot2)\nlibrary(readxl)\nipad_distanze_tutte <- read_csv(\"~/Documents/R_files/RSSIvsWIFI/data/ipad_distanze_tutte.csv\")\nipad_movimento <- read_csv(\"~/Documents/R_files/RSSIvsWIFI/data/ipad_movimento.csv\")\ntab_movimento <- read_csv(\"~/Documents/R_files/RSSIvsWIFI/data/tab_movimento.csv\")\ns3_distanze_tutte <- read_csv(\"~/Documents/R_files/RSSIvsWIFI/data/s3_distanze_tutte.csv\")\ntab_distanze_tutte <- read_csv(\"~/Documents/R_files/RSSIvsWIFI/data/tab_distanze_tutte.csv\")\nipad_distanze <- read_csv(\"~/Documents/R_files/RSSIvsWIFI/data/ipad_distanze.csv\")\ns3_distanze <- read_csv(\"~/Documents/R_files/RSSIvsWIFI/data/s3_distanze.csv\")\ntab_distanze <- read_csv(\"~/Documents/R_files/RSSIvsWIFI/data/tab_distanze.csv\")\nmovimentato_lg <- read_csv(\"~/Documents/R_files/RSSIvsWIFI/data/movimentato_lg.csv\")\nmovimentato_lg_milli <- read_csv(\"~/Documents/R_files/RSSIvsWIFI/data/movimentato_lg_milli.csv\")\nsams_wifiVSbt <- read_excel(\"~/Documents/R_files/RSSIvsWIFI/data/sams_wifiVSbt.xlsx\")\nlg_wifiVSbt <- read_excel(\"~/Documents/R_files/RSSIvsWIFI/data/lg_wifiVSbt.xlsx\", col_types = c(\"text\", \"numeric\", \"numeric\"))\nLG_WIFI_rssi_rx <- read_csv(\"~/Documents/R_files/RSSIvsWIFI/data/LG_WIFI_rssi+rx.csv\")\nSAMS_WIFI_rssi_rx <- read_csv(\"~/Documents/R_files/RSSIvsWIFI/data/SAMS_WIFI_rssi+rx.csv\")\nSAMS_1milli <- read_csv(\"~/Documents/R_files/RSSIvsWIFI/data/SAMS_1milli.csv\")\nLG_1milli <- read_csv(\"~/Documents/R_files/RSSIvsWIFI/data/LG_1milli.csv\")\n\n\n\ncolnames(LG_WIFI_rssi_rx)[4] <- \"distance\"\ncolnames(SAMS_WIFI_rssi_rx)[4] <- \"distance\"\ncolnames(SAMS_1milli)[4] <- \"distance\"\ncolnames(LG_1milli)[4] <- \"distance\"\ncolnames(s3_distanze)[1] <- \"rssi\"\ncolnames(s3_distanze)[2] <- \"rx\"\ncolnames(ipad_distanze)[1] <- \"rssi\"\ncolnames(ipad_distanze)[2] <- \"rx\"\ncolnames(tab_distanze)[1] <- \"rssi\"\ncolnames(tab_distanze)[2] <- \"rx\"\ntab_distanze = tab_distanze[-6,]\ntab_distanze = tab_distanze[-8,]\nipad_distanze = ipad_distanze[-6,]\n\n###### LG ######\nggplot(data = LG_WIFI_rssi_rx,aes(x = distance,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"LG WIFI distance\")\nggplot(data = LG_WIFI_rssi_rx,aes(x = distance,y = rssi, group=distance, color=distance)) + stat_sum() + ggtitle(\"LG RSSI distance\")\n\nggplot(data = LG_WIFI_rssi_rx,aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"LG WIFI rssiVSrx\")\n\nggplot(data = LG_1milli,aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"LG precisione decimo secondi\")\nplot(lg_wifiVSbt$wifi, lg_wifiVSbt$bluetooth)\nabline(lm(lg_wifiVSbt$bluetooth ~ lg_wifiVSbt$wifi))\nplot(sams_wifiVSbt$wifi, sams_wifiVSbt$bluetooth)\nlgdist.lm = lm(lg_wifiVSbt$wifi ~ lg_wifiVSbt$bluetooth)\nsams.lm = lm(sams_wifiVSbt$wifi ~ sams_wifiVSbt$bluetooth)\nsummary(lgdist.lm)$r.squared \nsummary(sams.lm)$r.squared \nabline(lm(sams_wifiVSbt$bluetooth ~ sams_wifiVSbt$wifi))\n\nplot(movimentato_lg_milli$rssi, movimentato_lg_milli$rx)\nabline(lm(movimentato_lg_milli$rx ~ movimentato_lg_milli$rssi))\n\nplot(tab_movimento$rssi, tab_movimento$rx)\nabline(lm(tab_movimento$rx ~ tab_movimento$rssi))\n\nplot(ipad_movimento$rssi, ipad_movimento$rx)\nabline(lm(ipad_movimento$rx ~ ipad_movimento$rssi))\nipad.lm = lm(ipad_movimento$rx ~ ipad_movimento$rssi)\nsummary(ipad.lm)$r.squared \n\nplot(movimentato_lg$rssi, movimentato_lg$rx)\nabline(lm(movimentato_lg$rx ~ movimentato_lg$rssi))\nlg.lm = lm(movimentato_lg$rx ~ movimentato_lg$rssi)\nsummary(lg.lm)$r.squared \n\nplot(s3_distanze_tutte$rssi, s3_distanze_tutte$rx)\nabline(lm(s3_distanze_tutte$rx ~ s3_distanze_tutte$rssi))\ns3.lm = lm(s3_distanze_tutte$rx ~ s3_distanze_tutte$rssi)\nsummary(s3.lm)$r.squared \n\nlm(s3_distanze_tutte$rx ~ s3_distanze_tutte$rssi)\n#plot(ipad_distanze_tutte$rssi, ipad_distanze_tutte$rx)\n#abline(lm(ipad_distanze$rx ~ ipad_distanze$rssi))\n#plot(tab_distanze_tutte$rssi, tab_distanze_tutte$rx)\n#abline(lm(tab_distanze$rx ~ tab_distanze$rssi))\n\nggplot(data = subset(LG_WIFI_rssi_rx, distance==\"02\"),aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"LG WIFI rssiVSrx 2 metri\") + geom_abline(intercept = -69.492104, slope = 0.001928)\nggplot(data = subset(LG_WIFI_rssi_rx, distance==\"03\"),aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"LG WIFI rssiVSrx 3 metri\") + geom_abline(intercept = -75.538239, slope = -0.005886)\nggplot(data = subset(LG_WIFI_rssi_rx, distance==\"04\"),aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"LG WIFI rssiVSrx 4 metri\") + geom_abline(intercept = -76.55839, slope = -0.09703)\nggplot(data = subset(LG_WIFI_rssi_rx, distance==\"05\"),aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"LG WIFI rssiVSrx 5 metri\") + geom_abline(intercept = -72.70959, slope = 0.03244)\nggplot(data = subset(LG_WIFI_rssi_rx, distance==\"06\"),aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"LG WIFI rssiVSrx 6 metri\") + geom_abline(intercept = -79.332647, slope = -0.003577)\nggplot(data = subset(LG_WIFI_rssi_rx, distance==\"07\"),aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"LG WIFI rssiVSrx 7 metri\") + geom_abline(intercept = -75.64089, slope = 0.04908)\nggplot(data = subset(LG_WIFI_rssi_rx, distance==\"08\"),aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"LG WIFI rssiVSrx 8 metri\") + geom_abline(intercept = -82.60443, slope = -0.09167)\nggplot(data = subset(LG_WIFI_rssi_rx, distance==\"09\"),aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"LG WIFI rssiVSrx 9 metri\") + geom_abline(intercept = -70.986, slope = 0.314)\nggplot(data = subset(LG_WIFI_rssi_rx, distance==\"10\"),aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"LG WIFI rssiVSrx 10 metri\") + geom_abline(intercept = -79.8382, slope = 0.1691)\n\n\n###### SAMS ######\nggplot(data = SAMS_WIFI_rssi_rx,aes(x = distance,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"SAMS WIFI distance\")\nggplot(data = SAMS_WIFI_rssi_rx,aes(x = distance,y = rssi, group=distance, color=distance)) + stat_sum() + ggtitle(\"SAMS WIFI distance\")\n\nggplot(data = SAMS_WIFI_rssi_rx,aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"SAMS WIFI rssiVSrx\")\n\n\nggplot(data = subset(SAMS_WIFI_rssi_rx, distance==\"02\"),aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"SAMS WIFI rssiVSrx 2 metri\") + geom_abline(intercept = -57.17278, slope = 0.06604)\nggplot(data = subset(SAMS_WIFI_rssi_rx, distance==\"03\"),aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"SAMS WIFI rssiVSrx 3 metri\") + geom_abline(intercept = -63.544673, slope = 0.004319)\nggplot(data = subset(SAMS_WIFI_rssi_rx, distance==\"04\"),aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"SAMS WIFI rssiVSrx 4 metri\") + geom_abline(intercept = -58.94305, slope = -0.03643)\nggplot(data = subset(SAMS_WIFI_rssi_rx, distance==\"05\"),aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"SAMS WIFI rssiVSrx 5 metri\") + geom_abline(intercept = -63.29443, slope = 0.07733)\nggplot(data = subset(SAMS_WIFI_rssi_rx, distance==\"06\"),aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"SAMS WIFI rssiVSrx 6 metri\") + geom_abline(intercept = -76.700, slope = -0.041)\nggplot(data = subset(SAMS_WIFI_rssi_rx, distance==\"07\"),aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"SAMS WIFI rssiVSrx 7 metri\") + geom_abline(intercept = -86.16365, slope = -0.02398)\nggplot(data = subset(SAMS_WIFI_rssi_rx, distance==\"08\"),aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"SAMS WIFI rssiVSrx 8 metri\") + geom_abline(intercept = -73.92652, slope = -0.02643)\nggplot(data = subset(SAMS_WIFI_rssi_rx, distance==\"09\"),aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"SAMS WIFI rssiVSrx 9 metri\") + geom_abline(intercept = -82.4991, slope = 0.1214)\nggplot(data = subset(SAMS_WIFI_rssi_rx, distance==\"10\"),aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"SAMS WIFI rssiVSrx 10 metri\") + geom_abline(intercept = -72.93996, slope = 0.04053)\n\nggplot(data = SAMS_1milli,aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"SAMS precisione decimo secondi\")\n\nggplot(data = subset(SAMS_WIFI_rssi_rx, distance==\"02\"),aes(x = rssi,y = rx, group=distance, color=distance)) + stat_sum() + ggtitle(\"SAMS WIFI rssiVSrx 2 metri\")\nplot(subset(SAMS_WIFI_rssi_rx, distance==\"02\")$rssi,subset(SAMS_WIFI_rssi_rx, distance==\"02\")$rx)\nlm(subset(SAMS_WIFI_rssi_rx, distance==\"03\")$rx ~ subset(SAMS_WIFI_rssi_rx, distance==\"03\")$rssi)\nmean(subset(SAMS_WIFI_rssi_rx, distance==\"03\")$rx)\n\n\nmin.mean.sd.max <- function(x) {\n  r <- c(min(x), mean(x) - sd(x), mean(x), mean(x) + sd(x), max(x))\n  names(r) <- c(\"ymin\", \"lower\", \"middle\", \"upper\", \"ymax\")\n  r\n}\n\nbplot_sam1_rssi <- ggplot(aes(y = rssi, x = factor(distance), color= distance), data = LG_WIFI_rssi_rx)\nbplot_sam1_rssi <- bplot_sam1_rssi + stat_summary(fun.data = min.mean.sd.max, geom = \"boxplot\") + geom_jitter(position=position_jitter(width=.2), size=3)\nbplot_sam1_rssi <- bplot_sam1_rssi + ggtitle(\"LG\") + xlab(\"Distanza\") + ylab(\"RSSI\") \nbplot_sam1_rssi\n\n\nmean(subset(LG_WIFI_rssi_rx$rx, LG_WIFI_rssi_rx$distance == \"02\"))\n\nc(mean(subset(SAMS_WIFI_rssi_rx$rssi, SAMS_WIFI_rssi_rx$distance == \"02\")), mean(subset(SAMS_WIFI_rssi_rx$rssi, SAMS_WIFI_rssi_rx$distance == \"03\")), mean(subset(SAMS_WIFI_rssi_rx$rssi, SAMS_WIFI_rssi_rx$distance == \"04\")), mean(subset(SAMS_WIFI_rssi_rx$rssi, SAMS_WIFI_rssi_rx$distance == \"05\")), mean(subset(SAMS_WIFI_rssi_rx$rssi, SAMS_WIFI_rssi_rx$distance == \"06\")), mean(subset(SAMS_WIFI_rssi_rx$rssi, SAMS_WIFI_rssi_rx$distance == \"07\")), mean(subset(SAMS_WIFI_rssi_rx$rssi, SAMS_WIFI_rssi_rx$distance == \"08\")), mean(subset(SAMS_WIFI_rssi_rx$rssi, SAMS_WIFI_rssi_rx$distance == \"09\")), mean(subset(SAMS_WIFI_rssi_rx$rssi, SAMS_WIFI_rssi_rx$distance == \"10\")))\n",
    "created" : 1504706671923.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1301553522",
    "id" : "641194A4",
    "lastKnownWriteTime" : 1499781279,
    "last_content_update" : 1499781279,
    "path" : "~/Documents/R_files/RSSIvsWIFI/script/RSSIvsWIFI.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}